"use strict";statracker.controller("HomeController",[function(){}]),statracker.controller("AccountController",["$scope","$state","accountService",function(e,t,r){e.user=r.user(),e.doLogout=function(){r.logout(),t.go("login")}}]),statracker.factory("accountService",["$http","$q","localStore","jwtHelper","apiUrl","clientId",function(e,t,r,s,o,n){var a={authenticated:!1},i=function(i){var u=t.defer(),c="grant_type=password&username="+i.email+"&password="+i.password+"&client_id="+n;return e({url:o+"token",method:"POST",data:c,skipAuthorization:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){var t=s.decodeToken(e.access_token);a.authenticated=!0,a.id=t.nameid,a.name=t.sub,a.email=t.sub,r.set("user",a),r.set("access_token",e.access_token),r.set("refresh_token",e.refresh_token),u.resolve()}).error(function(e){l(),u.reject(e)}),u.promise},l=function(){return a.authenticated&&e.post(o+"api/account/logout").then(function(){r.remove("access_token"),r.remove("refresh_token"),r.remove("user")}),a={authenticated:!1}},u=function(t){return l(),e({url:o+"api/account/register",method:"POST",data:t,skipAuthorization:!0})},c=function(){if(void 0!==a.id)return a;var e=r.get("user");return void 0!==e&&null!==e&&(a=e),a},d=function(){var t=r.get("refresh_token"),s="grant_type=refresh_token&refresh_token="+t+"&client_id="+n;return t?e({url:o+"token",method:"POST",skipAuthorization:!0,data:s,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){r.set("access_token",e.access_token),r.set("refresh_token",e.refresh_token)}).error(function(){l()}):void 0};return{login:i,logout:l,register:u,user:c,refresh:d}}]),statracker.controller("LoginController",["$state","accountService",function(e,t){var r=this;r.credentials={email:"",password:"",hasError:!1,error:""},r.canLogin=function(){return r.credentials.email&&r.credentials.email.length>0&&r.credentials.password&&r.credentials.password.length>0?!0:!1},this.doLogin=function(){r.credentials.hasError=!1,r.credentials.error="",t.login(this.credentials).then(function(){e.go("tab.rounds")},function(e){r.credentials.hasError=!0,r.credentials.error=null===e?"Cannot reach the StaTracker authorization server":e.error_description})}}]),statracker.directive("login",[function(){return{scope:{},templateUrl:"js/account/login.html",replace:!0,bindToController:!0,controller:"loginController",controllerAs:"ctrl"}}]).controller("loginController",["$state","accountService",function(e,t){this.credentials={email:"",password:"",hasError:!1,error:""},this.doLogin=function(){this.credentials.hasError=!1,this.credentials.error="",t.login(this.credentials).success(function(){e.go("tab.rounds")}).error(function(e){this.credentials.hasError=!0,this.credentials.error=e.error_description})}}]),statracker.controller("MyBagController",["$scope","$ionicModal","userDataService","userData",function(e,t,r,s){var o=this;o.clubs=s.clubs,o.showDelete=!1,r.getDefaultClubs().then(function(r){e.clubs=r,t.fromTemplateUrl("src/account/edit-club-modal.html",{scope:e}).then(function(e){o.modal=e})}),e.cancel=function(){o.modal.hide()},e.save=function(){o.modal.hide();var t=e.currentClub;if(e.inEditMode)r.updateClub(t);else{var s=e.clubs.find(function(e){return e.key===t.clubKey});t.club.key=s.key,t.club.clubName=s.name,r.addClub(t).then(function(e){o.clubs=e})}},e.$on("$destroy",function(){o.modal.remove()}),o.editClub=function(t){e.inEditMode=!0,t||(t={key:0,club:{key:-1,clubName:""},teeballFlag:!1,approachFlag:!1,sortOrderNumber:99},e.inEditMode=!1),e.currentClub=t,o.modal.show()},o.deleteClub=function(e){r.removeClub(e).then(function(e){o.clubs=e})}}]),statracker.directive("myCourses",["$ionicTemplateLoader","$ionicBackdrop","$timeout","$rootScope","$document",function(e,t,r,s,o){return{require:"?ngModel",restrict:"E",template:'<input type="text" class="my-courses-control" autocomplete="off">',replace:!0,scope:{courses:"="},link:function(s,n,a,i){s.filteredCourses=s.courses;var l,u=['<div class="my-courses-container">','<div class="bar bar-header item-input-inset">','<label class="item-input-wrapper">','<i class="icon ion-ios7-search placeholder-icon"></i>','<input type="search" ng-model="searchQuery" placeholder="Enter a course description">',"</label>",'<button class="button button-clear">Save</button>',"</div>",'<ion-content class="has-header">',"<ion-list>",'<ion-item ng-repeat="course in filteredCourses" type="item-text-wrap" ng-click="selectCourse(course)">',"{{course.courseDescription}}","</ion-item>","</ion-list>","</ion-content>","</div>"].join("");e.compile({template:u,scope:s,appendTo:o[0].body}).then(function(e){var o=angular.element(e.element.find("input"));s.selectCourse=function(r){i.$setViewValue(r),i.$render(),e.element.css("display","none"),t.release()},s.$watch("searchQuery",function(e){l&&r.cancel(l),l=r(function(){e&&s.$apply(function(){s.courses&&s.courses.length>0&&(s.filteredCourses=s.courses.filter(function(t){return""===e||t.courseDescription.startsWith(e)?t:void 0}))})},100)});var a=function(r){r.preventDefault(),r.stopPropagation(),t.retain(),e.element.css("display","block"),o[0].focus(),setTimeout(function(){o[0].focus()},0)},u=function(){var r={key:0,courseDescription:o[0].value};i.$setViewValue(r),i.$render(),s.searchQuery="",t.release(),e.element.css("display","none"),s.$emit("new-course",o[0].value)};n.bind("click",a),n.bind("touchend",a),e.element.find("button").bind("click",u)}),a.placeholder&&n.attr("placeholder",a.placeholder),i.$formatters.unshift(function(e){return e?e:""}),i.$parsers.unshift(function(e){return e}),i.$render=function(){n.val(i.$viewValue?i.$viewValue.courseDescription||"":"")}}}}]),statracker.controller("PreferencesController",[function(){}]),statracker.controller("RegisterController",["$state","accountService","userDataService",function(e,t,r){var s=this,o=[{key:0,clubKey:0,club:{key:0,clubName:"Driver"},teeballFlag:!0,approachFlag:!1,sortOrderNumber:1},{key:0,clubKey:0,club:{key:0,clubName:"3 Wood"},teeballFlag:!0,approachFlag:!1,sortOrderNumber:2},{key:0,clubKey:0,club:{key:0,clubName:"5 Wood"},teeballFlag:!0,approachFlag:!1,sortOrderNumber:3},{key:0,clubKey:0,club:{key:0,clubName:"4 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:4},{key:0,clubKey:0,club:{key:0,clubName:"5 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:5},{key:0,clubKey:0,club:{key:0,clubName:"6 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:6},{key:0,clubKey:0,club:{key:0,clubName:"7 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:7},{key:0,clubKey:0,club:{key:0,clubName:"8 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:8},{key:0,clubKey:0,club:{key:0,clubName:"9 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:9},{key:0,clubKey:0,club:{key:0,clubName:"Pitching Wedge"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:10},{key:0,clubKey:0,club:{key:0,clubName:"Sand Wedge"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:11}];r.getDefaultClubs().then(function(e){o.forEach(function(t,r){var s=e.find(function(e){return t.club.clubName===e.name});s?(o[r].clubKey=s.key,o[r].club.key=s.key):console.log("what gives?")}),r.addClubs(o).then(function(e){this.clubs=e})}),s.registration={email:"",password:"",confirmPassword:"",hasError:!1,error:""},s.doRegister=function(){s.registration.hasError=!1,s.registration.error="",s.validate()&&t.register(s.registration).success(function(){t.login(s.registration).then(function(){r.getDefaultClubs().then(function(t){o.forEach(function(e,r){var s=t.find(function(t){return e.club.clubName===t.name});s?(o[r].clubKey=s.key,o[r].club.key=s.key):console.log("what gives?")}),r.addClubs(o).then(function(){e.go("tab.rounds")})})})}).error(function(e){s.registration.hasError=!0,s.registration.error=e.error_description?e.error_description:e.modelState?e.modelState:e})},s.validate=function(){return""===s.registration.email?(s.registration.hasError=!0,s.registration.error="An email address is required",!1):""===s.registration.password?(s.registration.hasError=!0,s.registration.error="A password is required",!1):s.registration.password!==s.registration.confirmPassword?(s.registration.hasError=!0,s.registration.error="The passwords do not match",!1):!0}}]),statracker.factory("userDataService",["$http","$q","apiUrl",function(e,t,r){var s=[],o=[],n=[],a=function(){var n=t.defer(),a=t.defer();return s&&s.length>0?n.resolve(s):e.get(r+"/api/users/clubs").then(function(e){e.data&&(s=e.data),n.resolve(s)}),o&&o.length>0?a.resolve(o):e.get(r+"/api/users/courses").then(function(e){e.data&&(o=e.data),a.resolve(o)}),t.all([n.promise,a.promise]).then(function(e){return{clubs:e[0],courses:e[1]}})},i=function(s){var n=t.defer(),a=o&&o.find(function(e){return e.courseDescription.toLowerCase()===s.toLowerCase()});return a?n.resolve(void 0):e.post(r+"/api/users/courses",{courseDescription:s}).then(function(e){o.push(e.data),n.resolve(e.data)}),n.promise},l=function(o){var n=t.defer();return e.post(r+"/api/users/clubs",o).then(function(e){o.key=e.data.key,s.push(o),n.resolve(s)}),n.promise},u=function(o){var n=t.defer();return e.put(r+"/api/users/clubs",o).then(function(){e.get(r+"/api/users/clubs").then(function(e){e.data&&(s=e.data,n.resolve(s))})}),n.promise},c=function(t){var o=s.findIndex(function(e){return e.key===t.key});e.put(r+"/api/users/clubs/"+t.key,t).then(function(e){t.key=e.data.key,s[o]=t})},d=function(o){var n=t.defer(),a=s.findIndex(function(e){return e.key===o.key});return e.delete(r+"/api/users/clubs/"+o.key).then(function(){s.splice(a,1),n.resolve(s)}),n.promise},h=function(){var s=t.defer();return n&&n.length>0?s.resolve(n):e.get(r+"/api/clubs").then(function(e){e.data&&(n=e.data.map(function(e){var t=!0,r=!1;return"Driver"===e.clubName||e.clubName.endsWith("Wood")?(t=!1,r=!0):"Putter"===e.clubName&&(t=!1),{key:e.key,name:e.clubName,sortOrder:e.key,approachFlag:t,teeballFlag:r}})),s.resolve(n)}),s.promise};return{get clubs(){return s},get courses(){return o},getDefaultClubs:h,loadUserData:a,addCourse:i,addClub:l,addClubs:u,updateClub:c,removeClub:d}}]),statracker.config(["$httpProvider","jwtInterceptorProvider",function(e,t){t.tokenGetter=["localStore","jwtHelper","accountService",function(e,t,r){var s=e.get("access_token"),o=e.get("refresh_token");return s&&o?t.isTokenExpired(s)?r.refresh().then(function(t){var r=t.data.access_token;return e.set("access_token",r),r}):s:null}],e.interceptors.push("jwtInterceptor")}]),statracker.run(["$rootScope","$state","accountService",function(e,t,r){e.$on("$stateChangeStart",function(e,s){var o=r.user(),n=s&&s.data&&s.data.secure;!n||void 0!==o&&o.authenticated||(e.preventDefault(),t.go("login"))})}]),statracker.config(["$httpProvider",function(e){e.interceptors.push(function(e,t){return{request:function(t){return e.$broadcast("loading:show"),t},response:function(t){return e.$broadcast("loading:hide"),t},responseError:function(r){return e.$broadcast("loading:hide"),t.reject(r)}}})}]),statracker.run(["$rootScope","$ionicLoading",function(e,t){e.$on("loading:show",function(){t.show({template:"Loading...",noBackdrop:!0})}),e.$on("loading:hide",function(){t.hide()})}]),statracker.config(["$ionicConfigProvider",function(e){e.tabs.position("bottom"),e.backButton.previousTitleText(!1),e.backButton.icon("ion-ios7-arrow-left")}]).run(function(e){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault()})}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(e,t){return t=t||0,this.lastIndexOf(e,t)===t}}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(e,t){var r=this.toString();(void 0===t||t>r.length)&&(t=r.length),t-=e.length;var s=r.indexOf(e,t);return-1!==s&&s===t}}),Array.prototype.find||(Array.prototype.find=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,r=Object(this),s=r.length>>>0,o=arguments[1],n=0;s>n;n++)if(t=r[n],e.call(o,t,n,r))return t;return void 0}),Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,r=Object(this),s=r.length>>>0,o=arguments[1],n=0;s>n;n++)if(t=r[n],e.call(o,t,n,r))return n;return-1}),statracker.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{url:"/login",templateUrl:"src/account/login-page.html"}).state("register",{url:"/register",templateUrl:"src/account/register-page.html"}).state("tab",{url:"/tab","abstract":!0,templateUrl:"src/tabs.html",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]},data:{secure:!0}}).state("tab.settings",{url:"/settings",views:{settings:{templateUrl:"src/account/settings.html",controller:"AccountController"}}}).state("tab.preferences",{url:"/preferences",views:{settings:{templateUrl:"src/account/preferences.html",controller:"PreferencesController"}}}).state("tab.my-bag",{url:"/my-bag",views:{settings:{templateUrl:"src/account/my-bag-page.html",controller:"MyBagController as vm",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.rounds",{url:"/rounds",views:{rounds:{templateUrl:"src/rounds/list-page.html"}}}).state("tab.new-round",{url:"/new-round",views:{rounds:{templateUrl:"src/rounds/create-page.html",controller:"CreateRoundController as ctrl",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.round-summary",{url:"/round-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/round-summary.html",controller:"RoundController"}}}).state("tab.teeball-summary",{url:"/teeball-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/teeball-summary.html",controller:"RoundController"}}}).state("tab.approach-summary",{url:"/approach-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/approach-summary.html",controller:"RoundController"}}}).state("tab.round-detail-teeball",{url:"/round-detail-teeball",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/teeball.html",controller:"TeeShotController as ctrl",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.round-detail-approach",{url:"/round-detail-approach",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/approach.html",controller:"ApproachShotController as ctrl",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.round-detail-shortgame",{url:"/round-detail-shortgame",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/shortgame.html",controller:"HoleController"}}}).state("tab.stats",{url:"/stats",views:{stats:{templateUrl:"src/stats/stats.html",controller:"StatsController"}}}).state("tab.stats.overall",{url:"/overall",views:{"stats-detail":{templateUrl:"src/stats/overall.html"}}}).state("tab.stats.teeball",{url:"/teeball",views:{"stats-detail":{templateUrl:"src/stats/teeball.html"}}}).state("tab.stats.approach",{url:"/approach",views:{"stats-detail":{templateUrl:"src/stats/approach.html"}}}).state("tab.stats.shortgame",{url:"/shortgame",views:{"stats-detail":{templateUrl:"src/stats/shortgame.html"}}}),t.otherwise("/login")}]),statracker.factory("localStore",["store",function(e){return e.getNamespacedStore("stk")}]),statracker.controller("CreateRoundController",["$scope","$state","userDataService","roundService","userData",function(e,t,r,s,o){var n=this;n.courses=o.courses,n.round={date:new Date,holes:18,course:{key:0,courseDescription:""},hasError:!1,error:""},n.canStart=function(){return!0},n.startRound=function(){var e=s.create(n.round.course,n.round.date,n.round.holes);s.update(e,!0).then(function(e){t.go("^.round-detail-teeball({id: "+e.key+", hole: 1})")})},e.$on("new-course",function(e,t){r.addCourse(t).then(function(e){e&&(n.round.course.key=e.key)})})}]),statracker.controller("HoleController",["$scope","$state",function(e,t){e.round||(e.round={}),e.round.id=t.params.id,e.hole||(e.hole={}),e.hole.number=t.params.hole,e.gotoSummary=function(){var e=t.params;e.hole=void 0,t.go("^.round-summary",e)}}]),statracker.controller("ListRoundsController",["$state","roundService",function(e,t){var r=this;r.rounds=[],t.getAll().then(function(e){r.rounds=e.data})}]),statracker.directive("navNext",["$state","$ionicGesture","$ionicViewSwitcher",function(e,t,r){return{restrict:"A",link:function(s,o,n){var a=n.navNext;t.on("swipe",function(t){"left"===t.gesture.direction&&(t.preventDefault(),r.nextDirection("forward"),e.is("tab.round-detail-shortgame")&&(r.nextDirection("swap"),void 0!==e.params.hole&&3==e.params.hole?e.params.hole=1:e.params.hole+=1),e.go(a,e.params,{location:"replace"}))},o)}}}]),statracker.directive("navPrev",["$state","$ionicGesture","$ionicViewSwitcher",function(e,t,r){return{restrict:"A",link:function(s,o,n){var a=n.navPrev;t.on("swipe",function(t){"right"===t.gesture.direction&&(t.preventDefault(),r.nextDirection("back"),e.is("tab.round-detail-teeball")&&(r.nextDirection("swap"),void 0!==e.params.hole&&1==e.params.hole?e.params.hole=3:e.params.hole-=1),e.go(a,e.params,{location:"replace"}))},o)}}}]),statracker.controller("RoundController",["$scope","$state",function(e,t){e.round||(e.round={}),e.round.id=t.params.id,e.gotoDetails=function(){var e=t.params;e.hole=1,t.go("^.round-detail-teeball",e)}}]),statracker.factory("roundService",["$http","$q","localStore","apiUrl",function(e,t,r,s){var o,n=function(){return o?o:o=r.get("round")},a=function(n){var a=t.defer();return e.get(s+"/api/rounds/"+n).then(function(e){o=new statracker.Round(null,null,null,e.data),r.set("round",o),a.resolve(o)}),a.promise},i=function(){return e.get(s+"/api/rounds")},l=function(e,t,s){return o=new statracker.Round(e,t,s),r.set("round",o),o},u=function(n,a){var i=t.defer();if(o=n,a){var l=o.toApi();o.key&&o.key>0?e.put(s+"/api/rounds/"+o.key,l).then(function(){r.set("round",o),i.resolve(o)}):e.post(s+"/api/rounds",l).then(function(e){o.key=e.data.key,r.set("round",o),i.resolve(o)})}else r.set("round",o),i.resolve(o);return i.promise},c=function(e){u(e),r.remove("round")},d=function(t){e.delete(s+"/api/rounds/"+t).then(function(){o&&o.key===t&&(o=void 0,r.remove("round"))})};return{getCurrent:n,getOne:a,getAll:i,create:l,update:u,complete:c,"delete":d}}]),function(e){var t,r,s;t=function(t){var r;for(this.key=t.key,this.datePlayed=t.roundDate,this.courseKey=t.courseKey,this.holes=t.holesCount,this.score=t.scoreNumber,this.greens=t.greensNumber,this.fairways=t.fairwaysNumber,this.penalties=t.penaltiesNumber,this.sandSaveAttempts=t.sandSaveAttemptsNumber,this.sandSaveConversions=t.sandSaveConvertedNumber,this.upAndDownAttempts=t.upAndDownAttemptsNumber,this.upAndDownConversions=t.upAndDownConvertedNumber,this.teeShots=[],this.approachShots=[],this.shortGameShots=[],r=0;r<t.holesCount;r++)this.teeShots.push(new e.TeeShot(r+1,t.teeShots[r])),this.approachShots.push(new e.ApproachShot(r+1,t.approachShots[r])),this.shortGameShots.push(new e.ShortGame(r+1,t.shortGameShots[r]))},s=function(r,s,o,n){var a;if(n)t(n);else for(this.key=void 0,this.courseKey=r.key,this.courseName=r.description,this.datePlayed=s,this.holes=o,this.score=void 0,this.greens=void 0,this.fairways=void 0,this.penalties=void 0,this.sandSaveAttempts=void 0,this.sandSaveConversions=void 0,this.upAndDownAttempts=void 0,this.upAndDownConversions=void 0,this.teeShots=[],this.approachShots=[],this.shortGameShots=[],a=1;o>=a;a++)this.teeShots.push(new e.TeeShot(a)),this.approachShots.push(new e.ApproachShot(a)),this.shortGameShots.push(new e.ShortGame(a))},r=function(){var e,t={key:this.key,roundDate:this.datePlayed,courseKey:this.courseKey,holesCount:this.holes,scoreNumber:this.score,greensNumber:this.greens,fairwaysNumber:this.fairways,penaltiesNumber:this.penalties,sandSaveAttemptsNumber:this.sandSaveAttempts,sandSaveConvertedNumber:this.sandSaveConversions,upAndDownAttemptsNumber:this.upAndDownAttempts,upAndDownConvertedNumber:this.upAndDownConversions,teeShots:[],approachShots:[],shortGameShots:[]};for(e=0;e<this.holes;e++)t.teeShots.push(this.teeShots[e].toApi()),t.approachShots.push(this.approachShots[e].toApi()),t.shortGameShots.push(this.shortGameShots[e].toApi());return t},s.prototype={constructor:s,toApi:r},e.Round=s}(statracker),statracker.controller("StatsController",["$scope","$state",function(e){e.is("tab.stats")&&e.go(".overall")}]),statracker.directive("approachResultInput",[function(){return{restrict:"AE",templateUrl:"src/rounds/approach/approach-result-input.html",replace:!0,scope:{shot:"="},link:function(e,t){var r=t.find("path"),s=document.querySelector("svg"),o="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xlink",a=document.getElementById("shots"),i=s.createSVGPoint(),l=function(e){return i.x=e.clientX,i.y=e.clientY,i.matrixTransform(s.getScreenCTM().inverse())},u=function(e,t,r){var s=document.createElementNS(o,"use"),i="translate("+e+","+t+") scale(1.0)";r&&c(),s.setAttributeNS(n,"xlink:href","#ball"),s.setAttributeNS(null,"transform",i),a.appendChild(s)},c=function(){if(a.hasChildNodes()){var e,t=a.children;for(e=0;e<t.length;e++)a.removeChild(t[e])}};e.$watch("shot",function(){e.shot.result&&e.shot.result>=0&&(e.resultText=e.shot.getResultText(),u(e.shot.coordinates.x,e.shot.coordinates.y,!0))}),r.bind("click",function(t){var r=l(t);e.shot.result=parseInt(this.getAttribute("data-location")),e.shot.coordinates.x=r.x,e.shot.coordinates.y=r.y,e.resultText=e.shot.getResultText(),u(r.x,r.y,!0)})}}}]),statracker.controller("ApproachShotController",["$state","roundService","userData",function(e,t,r){var s=this;s.clubs=r.clubs,s.round||(s.round=t.getCurrent(e.params.id)),s.shot||(s.shot=s.round.approachShots[e.params.hole-1]),s.gotoSummary=function(){var t=e.params;t.hole=void 0,e.go("^.round-summary",t)}}]),function(e){var t=["On the green, inside 6 feet","On the green, inside 12 feet, short","On the green, inside 12 feet, short right","On the green, inside 12 feet, right","On the green, inside 12 feet, long right","On the green, inside 12 feet, long","On the green, inside 12 feet, long left","On the green, inside 12 feet, left","On the green, inside 12 feet, short left","On the green, inside 30 feet, short","On the green, inside 30 feet, short right","On the green, inside 30 feet, right","On the green, inside 30 feet, long right","On the green, inside 30 feet, long","On the green, inside 30 feet, long left","On the green, inside 30 feet, left","On the green, inside 30 feet, short left","On the green, outside 30 feet, short","On the green, outside 30 feet, short right","On the green, outside 30 feet, right","On the green, outside 30 feet, long right","On the green, outside 30 feet, long","On the green, outside 30 feet, long left","On the green, outside 30 feet, left","On the green, outside 30 feet, short left","Missed green (less than 6 feet), short","Missed green (less than 6 feet), short right","Missed green (less than 6 feet), right","Missed green (less than 6 feet), long right","Missed green (less than 6 feet), long","Missed green (less than 6 feet), long left","Missed green (less than 6 feet), left","Missed green (less than 6 feet), short left","Missed green, short","Missed green, short right","Missed green, right","Missed green, long right","Missed green, long","Missed green, long left","Missed green, left","Missed green, short left"],r=function(e,t){t?(this.key=t.key,this.hole=t.holeNumber,this.clubKey=t.clubKey,this.yardage=t.yardageNumber,this.result=t.resultId,this.coordinates={x:t.resultXNumber,y:t.resultYNumber}):(this.key=void 0,this.hole=e,this.clubKey=void 0,this.yardage=void 0,this.result=void 0,this.coordinates=void 0)},s=function(){return{key:this.key,holeNumber:this.hole,clubKey:this.clubKey,yardageNumber:this.yardage,resultId:this.result,resultXNumber:this.coordinates?this.coordinates.x:void 0,resultYNumber:this.coordinates?this.coordinates.y:void 0}},o=function(){return t[this.result]};r.prototype={constructor:r,toApi:s,getResultText:o},e.ApproachShot=r}(statracker),statracker.directive("attemptInput",["$parse",function(e){return{restrict:"AE",templateUrl:"src/rounds/shortgame/attempt-input.html",replace:!0,require:"ngModel",link:function(t,r,s,o){var n=angular.element(document.querySelector("#make")),a=angular.element(document.querySelector("#miss")),i=e(s.ngModel)(t),l=function(){n.hasClass("unselected")||n.addClass("unselected"),a.hasClass("unselected")||a.addClass("unselected")},u=function(){n.hasClass("unselected")&&n.removeClass("unselected"),a.hasClass("unselected")||a.addClass("unselected")},c=function(){n.hasClass("unselected")||n.addClass("unselected"),a.hasClass("unselected")&&a.removeClass("unselected")};i===!0?u():i===!1?c():l(),n.bind("click",function(){o.$viewValue?(o.$setViewValue(void 0),l()):(o.$setViewValue(!0),u()),t.$apply()}),a.bind("click",function(){void 0===o.$viewValue||o.$viewValue===!0?(o.$setViewValue(!1),c()):(o.$setViewValue(void 0),l()),t.$apply()})}}}]),statracker.directive("puttsInput",["$parse",function(e){return{restrict:"AE",templateUrl:"src/rounds/shortgame/putts-input.html",replace:!0,require:"ngModel",link:function(t,r,s,o){var n=r.find("circle"),a=e(s.ngModel)(t),i=function(){n.forEach(function(e){e.hasClass("unselected")||e.addClass("unselected"),e.hasClass("selected")&&e.removeClass("selected")})},l=function(e){n.forEach(function(t){var r=parseInt(t.getAttribute("data-value"));r===e?(t.hasClass("selected")||t.addClass("selected"),t.hasClass("unselected")&&t.removeClass("unselected")):(t.hasClass("unselected")||t.addClass("unselected"),t.hasClass("selected")&&t.removeClass("selected"))})};void 0!==a?l(a):i(),n.bind("click",function(){var e=parseInt(this.getAttribute("data-value"));o.$setViewValue(e),l(e),t.$apply()})}}}]),statracker.controller("ShortGameController",["$state","roundService",function(e,t){var r=this;r.round||(r.round=t.getCurrent(e.params.id)),r.shot||(r.shot=r.round.approachShots[e.params.hole-1]),r.gotoSummary=function(){var t=e.params;t.hole=void 0,e.go("^.round-summary",t)}}]),function(e){var t=function(e,t){t?(this.key=t.key,this.hole=t.holeNumber,this.initialPuttLength=t.initialLengthNumber,this.puttMadeLength=t.finalLengthNumber,this.putts=t.puttsCount,this.upAndDown=t.upAndDownFlag,this.sandSave=t.sandSaveFlag,this.holeOut=t.holeOutFlag):(this.key=void 0,this.hole=e,this.initialPuttLength=void 0,this.puttMadeLength=void 0,this.putts=void 0,this.upAndDown=void 0,this.sandSave=void 0,this.holeOut=void 0)},r=function(){return{key:this.key,holeNumber:this.hole,initialLengthNumber:this.initialPuttLength,finalLengthNumber:this.puttMadeLength,puttsCount:this.putts,upAndDownFlag:this.upAndDown,sandSaveFlag:this.sandSave,holeOutFlag:this.holeOut}};t.prototype={constructor:t,toApi:r},e.ShortGame=t}(statracker),statracker.directive("teeResultInput",[function(){return{restrict:"AE",templateUrl:"src/rounds/tee/tee-result-input.html",replace:!0,scope:{shot:"="},link:function(e,t){var r=t.find("rect"),s=document.querySelector("svg"),o="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xlink",a=document.getElementById("shots"),i=s.createSVGPoint(),l=function(e){return i.x=e.clientX,i.y=e.clientY,i.matrixTransform(s.getScreenCTM().inverse())},u=function(e,t,r){var s=document.createElementNS(o,"use"),i="translate("+e+","+t+") scale(1.0)";r&&c(),s.setAttributeNS(n,"xlink:href","#ball"),s.setAttributeNS(null,"transform",i),a.appendChild(s)},c=function(){if(a.hasChildNodes()){var e,t=a.children;for(e=0;e<t.length;e++)a.removeChild(t[e])}};e.$watch("shot",function(){e.shot.result&&e.shot.result>=0&&(e.resultText=e.shot.getResultText(),u(e.shot.coordinates.x,e.shot.coordinates.y,!0))}),r.bind("click",function(t){var r=l(t);e.shot.result=parseInt(this.getAttribute("data-location")),e.shot.coordinates.x=r.x,e.shot.coordinates.y=r.y,e.resultText=e.shot.getResultText(),u(r.x,r.y,!0)})}}}]),statracker.controller("TeeShotController",["$state","roundService","userData",function(e,t,r){var s=this;s.clubs=r.clubs,s.round||(s.round=t.getCurrent(e.params.id)),s.shot||(s.shot=s.round.approachShots[e.params.hole-1]),s.gotoSummary=function(){var t=e.params;t.hole=void 0,e.go("^.round-summary",t)}}]),function(e){var t=["Fairway, less than 200 yards","Miss left (first cut up to 2 paces), less than 200 yards","Miss right (first cut up to 2 paces), less than 200 yards","Big miss left, less than 200 yards","Big miss right, less than 200 yards","Out of play (hazard or OB) left, less than 200 yards","Out of play (hazard or OB) right, less than 200 yards","Fairway, 200 - 225 yards","Miss left (first cut up to 2 paces), 200 - 225 yards","Miss right (first cut up to 2 paces), 200 - 225 yards","Big miss left, 200 - 225 yards","Big miss right, 200 - 225 yards","Out of play (hazard or OB) left, 200 - 225 yards","Out of play (hazard or OB) right, 200 - 225 yards","Fairway, 225 - 250 yards","Miss left (first cut up to 2 paces), 225 - 250 yards","Miss right (first cut up to 2 paces), 225 - 250 yards","Big miss left, 225 - 250 yards","Big miss right, 225 - 250 yards","Out of play (hazard or OB) left, 225 - 250 yards","Out of play (hazard or OB) right, 225 - 250 yards","Fairway, 250 - 275 yards","Miss left (first cut up to 2 paces), 250 - 275 yards","Miss right (first cut up to 2 paces), 250 - 275 yards","Big miss left, 250 - 275 yards","Big miss right, 250 - 275 yards","Out of play (hazard or OB) left, 250 - 275 yards","Out of play (hazard or OB) right, 250 - 275 yards","Fairway, 275 - 300 yards","Miss left (first cut up to 2 paces), 275 - 300 yards","Miss right (first cut up to 2 paces), 275 - 300 yards","Big miss left, 275 - 300 yards","Big miss right, 275 - 300 yards","Out of play (hazard or OB) left, 275 - 300 yards","Out of play (hazard or OB) right, 275 - 300 yards","Fairway, over 300 yards","Miss left (first cut up to 2 paces), over 300 yards","Miss right (first cut up to 2 paces), over 300 yards","Big miss left, over 300 yards","Big miss left, over 300 yards","Out of play (hazard or OB) left, over 300 yards","Out of play (hazard or OB) right, over 300 yards"],r=function(e,t){t?(this.key=t.key,this.hole=t.holeNumber,this.clubKey=t.clubKey,this.distance=t.distanceNumber,this.result=t.resultId,this.coordinates={x:t.resultXNumber,y:t.resultYNumber}):(this.key=void 0,this.hole=e,this.clubKey=void 0,this.distance=void 0,this.result=void 0,this.coordinates=void 0)},s=function(){return{key:this.key,holeNumber:this.hole,clubKey:this.clubKey,distanceNumber:this.distance,resultId:this.result,resultXNumber:this.coordinates?this.coordinates.x:void 0,resultYNumber:this.coordinates?this.coordinates.y:void 0}};r.prototype={constructor:r,toApi:s,getResultText:function(){return t[this.result]}},e.TeeShot=r}(statracker);