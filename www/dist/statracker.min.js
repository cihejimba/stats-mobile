"use strict";statracker.controller("HomeController",[function(){}]),statracker.config(["$httpProvider","jwtInterceptorProvider",function(e,t){t.tokenGetter=["localStore","jwtHelper","accountService",function(e,t,r){var o=e.get("access_token"),n=e.get("refresh_token");return o&&n?t.isTokenExpired(o)?r.refresh().then(function(t){var r=t.data.access_token;return e.set("access_token",r),r}):o:null}],e.interceptors.push("jwtInterceptor")}]),statracker.run(["$rootScope","$state","accountService",function(e,t,r){e.$on("$stateChangeStart",function(e,o){var n=r.user(),s=o&&o.data&&o.data.secure;!s||void 0!==n&&n.authenticated||(e.preventDefault(),t.go("login"))})}]),statracker.config(["$httpProvider",function(e){e.interceptors.push(function(e,t){return{request:function(t){return e.$broadcast("loading:show"),t},response:function(t){return e.$broadcast("loading:hide"),t},responseError:function(r){return e.$broadcast("loading:hide"),t.reject(r)}}})}]),statracker.run(["$rootScope","$ionicLoading",function(e,t){e.$on("loading:show",function(){t.show({template:"Loading...",noBackdrop:!0})}),e.$on("loading:hide",function(){t.hide()})}]),statracker.config(["$ionicConfigProvider",function(e){e.tabs.position("bottom"),e.backButton.previousTitleText(!1),e.backButton.icon("ion-ios7-arrow-left")}]).run(function(e){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault()})}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(e,t){return t=t||0,this.lastIndexOf(e,t)===t}}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(e,t){var r=this.toString();(void 0===t||t>r.length)&&(t=r.length),t-=e.length;var o=r.indexOf(e,t);return-1!==o&&o===t}}),Array.prototype.find||(Array.prototype.find=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,r=Object(this),o=r.length>>>0,n=arguments[1],s=0;o>s;s++)if(t=r[s],e.call(n,t,s,r))return t;return void 0}),Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,r=Object(this),o=r.length>>>0,n=arguments[1],s=0;o>s;s++)if(t=r[s],e.call(n,t,s,r))return s;return-1}),statracker.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{url:"/login",templateUrl:"src/account/login-page.html"}).state("register",{url:"/register",templateUrl:"src/account/register-page.html"}).state("tab",{url:"/tab","abstract":!0,templateUrl:"src/tabs.html",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]},data:{secure:!0}}).state("tab.settings",{url:"/settings",views:{settings:{templateUrl:"src/account/settings.html",controller:"AccountController"}}}).state("tab.preferences",{url:"/preferences",views:{settings:{templateUrl:"src/account/preferences.html",controller:"PreferencesController"}}}).state("tab.my-bag",{url:"/my-bag",views:{settings:{templateUrl:"src/account/my-bag-page.html",controller:"MyBagController as vm",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.rounds",{url:"/rounds",views:{rounds:{templateUrl:"src/rounds/list-page.html"}}}).state("tab.new-round",{url:"/new-round",views:{rounds:{templateUrl:"src/rounds/create-page.html",controller:"CreateRoundController as ctrl",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.round-summary",{url:"/round-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/round-summary-page.html"}}}).state("tab.teeball-summary",{url:"/teeball-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/tee/tee-summary-page.html"}}}).state("tab.approach-summary",{url:"/approach-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/approach/approach-summary-page.html"}}}).state("tab.round-detail-teeball",{url:"/round-detail-teeball",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/tee/tee-page.html",controller:"TeeShotController as ctrl",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.round-detail-approach",{url:"/round-detail-approach",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/approach/approach-page.html",controller:"ApproachShotController as ctrl",resolve:{userData:["userDataService",function(e){return e.loadUserData()}]}}}}).state("tab.round-detail-shortgame",{url:"/round-detail-shortgame",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/shortgame/shortgame-page.html"}}}).state("tab.stats",{url:"/stats",views:{stats:{templateUrl:"src/stats/stats.html",controller:"StatsController"}}}).state("tab.stats.overall",{url:"/overall",views:{"stats-detail":{templateUrl:"src/stats/overall.html"}}}).state("tab.stats.teeball",{url:"/teeball",views:{"stats-detail":{templateUrl:"src/stats/teeball.html"}}}).state("tab.stats.approach",{url:"/approach",views:{"stats-detail":{templateUrl:"src/stats/approach.html"}}}).state("tab.stats.shortgame",{url:"/shortgame",views:{"stats-detail":{templateUrl:"src/stats/shortgame.html"}}}),t.otherwise("/login")}]),statracker.factory("localStore",["store",function(e){return e.getNamespacedStore("stk")}]),statracker.controller("CreateRoundController",["$scope","$state","userDataService","roundService","userData",function(e,t,r,o,n){var s=this;s.courses=n.courses,s.round={date:new Date,holes:18,course:{key:0,courseDescription:""},hasError:!1,error:""},s.canStart=function(){return!0},s.startRound=function(){var e=o.create(s.round.course,s.round.date,s.round.holes);o.update(e,!0).then(function(){t.go("^.round-detail-teeball")})},e.$on("new-course",function(e,t){r.addCourse(t).then(function(e){e&&(s.round.course.key=e.key)})})}]),statracker.directive("goto",["$ionicPopover",function(e){return{restrict:"AE",template:'<button class="button button-small ion-ios7-flag" ng-click="open($event)"> {{hole}}</button>',scope:{hole:"=",holes:"="},link:function(t){e.fromTemplateUrl("src/rounds/goto-popover.html",{scope:t}).then(function(e){t.popover=e}),t.open=function(e){t.popover.show(e)},t.goto=function(e){e<=t.holes&&t.$emit("hole_change",e),t.popover.hide()},t.$on("$destroy",function(){t.popover.remove()})}}}]),statracker.controller("HoleController",["$scope","$state",function(e,t){e.round||(e.round={}),e.round.id=t.params.id,e.hole||(e.hole={}),e.hole.number=t.params.hole,e.gotoSummary=function(){var e=t.params;e.hole=void 0,t.go("^.round-summary",e)}}]),statracker.directive("holeNext",["$state","$ionicGesture","$ionicViewSwitcher","roundService",function(e,t,r,o){return{restrict:"A",link:function(n,s,a){var i=a.holeNext;t.on("swipe",function(t){if("left"===t.gesture.direction){if(t.preventDefault(),r.nextDirection("forward"),e.is("tab.round-detail-shortgame")){r.nextDirection("swap");var n=o.getCurrentRound(),s=o.getCurrentHole();o.setCurrentHole(s==n.holes?1:s+1)}e.go(i,e.params,{location:"replace"})}},s)}}}]),statracker.directive("holePrev",["$state","$ionicGesture","$ionicViewSwitcher","roundService",function(e,t,r,o){return{restrict:"A",link:function(n,s,a){var i=a.holePrev;t.on("swipe",function(t){if("right"===t.gesture.direction){if(t.preventDefault(),r.nextDirection("back"),e.is("tab.round-detail-teeball")){r.nextDirection("swap");var n=o.getCurrentRound(),s=o.getCurrentHole();o.setCurrentHole(1==s?n.holes:s-1)}e.go(i,e.params,{location:"replace"})}},s)}}}]),statracker.controller("ListRoundsController",["$state","roundService",function(e,t){var r=this;r.rounds=[],t.getAll().then(function(e){r.rounds=e.data}),r.gotoSummary=function(r){t.loadRound(r).then(function(){e.go("tab.round-summary")})}}]),statracker.directive("navNext",["$state","$ionicGesture","$ionicViewSwitcher",function(e,t,r){return{restrict:"A",link:function(o,n,s){var a=s.navNext;t.on("swipe",function(t){"left"===t.gesture.direction&&(t.preventDefault(),r.nextDirection("forward"),e.go(a,e.params,{location:"replace"}))},n)}}}]),statracker.directive("navPrev",["$state","$ionicGesture","$ionicViewSwitcher",function(e,t,r){return{restrict:"A",link:function(o,n,s){var a=s.navPrev;t.on("swipe",function(t){"right"===t.gesture.direction&&(t.preventDefault(),r.nextDirection("back"),e.go(a,e.params,{location:"replace"}))},n)}}}]),statracker.controller("RoundController",["$scope","$state",function(e,t){e.round||(e.round={}),e.round.id=t.params.id,e.gotoDetails=function(){var e=t.params;e.hole=1,t.go("^.round-detail-teeball",e)}}]),statracker.factory("roundService",["$http","$q","localStore","apiUrl",function(e,t,r,o){var n,s=function(){return n?n:n=r.get("round")},a=function(a){var i=t.defer(),u=s();return u&&u.key===a?i.resolve(u):e.get(o+"/api/rounds/"+a).then(function(e){n=new statracker.Round(null,null,null,e.data),r.set("round",n),i.resolve(n)}),i.promise},i=function(){return e.get(o+"/api/rounds")},u=function(e,t,o){return n=new statracker.Round(e,t,o),r.set("round",n),n},l=function(s,a){var i=t.defer();if(n=s,a){var u=n.toApi();n.key&&n.key>0?e.put(o+"/api/rounds/"+n.key,u).then(function(){r.set("round",n),i.resolve(n)}):e.post(o+"/api/rounds",u).then(function(e){n.key=e.data.key,r.set("round",n),i.resolve(n)})}else r.set("round",n),i.resolve(n);return i.promise},c=function(e){l(e),r.remove("round")},d=function(t){e.delete(o+"/api/rounds/"+t).then(function(){n&&n.key===t&&(n=void 0,r.remove("round"))})};return{loadRound:a,getAll:i,getCurrentRound:s,setCurrentHole:function(e){r.set("hole",e)},getCurrentHole:function(){var e=r.get("hole");return e?e:1},create:u,update:l,complete:c,"delete":d}}]),statracker.controller("RoundSummaryController",["roundService","$state",function(e,t){var r=this;r.round=e.getCurrentRound(),r.gotoDetails=function(){var e=t.params;e.hole=1,t.go("^.round-detail-teeball",e)}}]),function(e){var t,r,o;t=function(t,r){var o;for(t.key=r.key,t.datePlayed=r.roundDate,t.courseKey=r.courseKey,t.courseDescription=r.course.courseDescription,t.holes=r.holesCount,t.score=r.scoreNumber,t.greens=r.greensNumber,t.fairways=r.fairwaysNumber,t.penalties=r.penaltiesNumber,t.teeShots=[],t.approachShots=[],t.shortGameShots=[],o=0;o<r.holesCount;o++)t.teeShots.push(new e.TeeShot(o+1,r.teeShots[o])),t.approachShots.push(new e.ApproachShot(o+1,r.approachShots[o])),t.shortGameShots.push(new e.ShortGame(o+1,r.shortGameShots[o]))},o=function(r,o,n,s){var a;if(s)t(this,s);else for(this.key=void 0,this.courseKey=r.key,this.courseDescription=r.courseDescription,this.datePlayed=o,this.holes=n,this.score=void 0,this.greens=void 0,this.fairways=void 0,this.penalties=void 0,this.teeShots=[],this.approachShots=[],this.shortGameShots=[],a=1;n>=a;a++)this.teeShots.push(new e.TeeShot(a)),this.approachShots.push(new e.ApproachShot(a)),this.shortGameShots.push(new e.ShortGame(a))},r=function(){var e,t={key:this.key,roundDate:this.datePlayed,courseKey:this.courseKey,holesCount:this.holes,scoreNumber:this.score,greensNumber:this.greens,fairwaysNumber:this.fairways,penaltiesNumber:this.penalties,teeShots:[],approachShots:[],shortGameShots:[]};for(e=0;e<this.holes;e++)t.teeShots.push(this.teeShots[e].toApi()),t.approachShots.push(this.approachShots[e].toApi()),t.shortGameShots.push(this.shortGameShots[e].toApi());return t},o.prototype={constructor:o,toApi:r},e.Round=o}(statracker),statracker.controller("StatsController",["$scope","$state",function(e){e.is("tab.stats")&&e.go(".overall")}]),statracker.controller("AccountController",["$scope","$state","accountService",function(e,t,r){e.user=r.user(),e.doLogout=function(){r.logout(),t.go("login")}}]),statracker.factory("accountService",["$http","$q","localStore","jwtHelper","apiUrl","clientId",function(e,t,r,o,n,s){var a={authenticated:!1},i=function(i){var l=t.defer(),c="grant_type=password&username="+encodeURIComponent(i.email)+"&password="+encodeURIComponent(i.password)+"&client_id="+encodeURIComponent(s);return e({url:n+"token",method:"POST",data:c,skipAuthorization:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){var t=o.decodeToken(e.access_token);a.authenticated=!0,a.id=t.nameid,a.name=t.sub,a.email=t.sub,r.set("user",a),r.set("access_token",e.access_token),r.set("refresh_token",e.refresh_token),l.resolve()}).error(function(e){u(),l.reject(e)}),l.promise},u=function(){return a.authenticated&&e.post(n+"api/account/logout"),r.remove("access_token"),r.remove("refresh_token"),r.remove("user"),a={authenticated:!1}},l=function(t){return u(),e({url:n+"api/account/register",method:"POST",data:t,skipAuthorization:!0})},c=function(){if(void 0!==a.id)return a;var e=r.get("user");return void 0!==e&&null!==e&&(a=e),a},d=function(){var t=r.get("refresh_token"),o="grant_type=refresh_token&refresh_token="+encodeURIComponent(t)+"&client_id="+encodeURIComponent(s);return t?e({url:n+"token",method:"POST",skipAuthorization:!0,data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){r.set("access_token",e.access_token),r.set("refresh_token",e.refresh_token)}).error(function(){u()}):void 0};return{login:i,logout:u,register:l,user:c,refresh:d}}]),statracker.controller("LoginController",["$state","accountService",function(e,t){var r=this;r.credentials={email:"",password:"",hasError:!1,error:""},r.canLogin=function(){return r.credentials.email&&r.credentials.email.length>0&&r.credentials.password&&r.credentials.password.length>0?!0:!1},this.doLogin=function(){r.credentials.hasError=!1,r.credentials.error="",t.login(this.credentials).then(function(){e.go("tab.rounds")},function(e){r.credentials.hasError=!0,r.credentials.error=null===e?"Cannot reach the StaTracker authorization server":e.error_description})}}]),statracker.directive("login",[function(){return{scope:{},templateUrl:"js/account/login.html",replace:!0,bindToController:!0,controller:"loginController",controllerAs:"ctrl"}}]).controller("loginController",["$state","accountService",function(e,t){this.credentials={email:"",password:"",hasError:!1,error:""},this.doLogin=function(){this.credentials.hasError=!1,this.credentials.error="",t.login(this.credentials).success(function(){e.go("tab.rounds")}).error(function(e){this.credentials.hasError=!0,this.credentials.error=e.error_description})}}]),statracker.controller("MyBagController",["$scope","$ionicModal","userDataService","userData",function(e,t,r,o){var n=this;n.clubs=o.clubs,n.showDelete=!1,r.getDefaultClubs().then(function(r){e.clubs=r,t.fromTemplateUrl("src/account/edit-club-modal.html",{scope:e}).then(function(e){n.modal=e})}),e.cancel=function(){n.modal.hide()},e.save=function(){n.modal.hide();var t=e.currentClub;if(e.inEditMode)r.updateClub(t);else{var o=e.clubs.find(function(e){return e.key===t.clubKey});t.club.key=o.key,t.club.clubName=o.name,r.addClub(t).then(function(e){n.clubs=e})}},e.$on("$destroy",function(){n.modal.remove()}),n.editClub=function(t){e.inEditMode=!0,t||(t={key:0,club:{key:-1,clubName:""},teeballFlag:!1,approachFlag:!1,sortOrderNumber:99},e.inEditMode=!1),e.currentClub=t,n.modal.show()},n.deleteClub=function(e){r.removeClub(e).then(function(e){n.clubs=e})}}]),statracker.directive("myCourses",["$ionicTemplateLoader","$ionicBackdrop","$timeout","$rootScope","$document",function(e,t,r,o,n){return{require:"?ngModel",restrict:"E",template:'<input type="text" class="my-courses-control" autocomplete="off">',replace:!0,scope:{courses:"="},link:function(o,s,a,i){o.filteredCourses=o.courses;var u,l=['<div class="my-courses-container">','<div class="bar bar-header item-input-inset">','<label class="item-input-wrapper">','<i class="icon ion-ios7-search placeholder-icon"></i>','<input type="search" ng-model="searchQuery" placeholder="Enter a course description">',"</label>",'<button class="button button-clear">Save</button>',"</div>",'<ion-content class="has-header">',"<ion-list>",'<ion-item ng-repeat="course in filteredCourses" type="item-text-wrap" ng-click="selectCourse(course)">',"{{course.courseDescription}}","</ion-item>","</ion-list>","</ion-content>","</div>"].join("");e.compile({template:l,scope:o,appendTo:n[0].body}).then(function(e){var n=angular.element(e.element.find("input"));o.selectCourse=function(r){i.$setViewValue(r),i.$render(),e.element.css("display","none"),t.release()},o.$watch("searchQuery",function(e){u&&r.cancel(u),u=r(function(){e&&o.$apply(function(){o.courses&&o.courses.length>0&&(o.filteredCourses=o.courses.filter(function(t){return""===e||t.courseDescription.startsWith(e)?t:void 0}))})},100)});var a=function(r){r.preventDefault(),r.stopPropagation(),t.retain(),e.element.css("display","block"),n[0].focus(),setTimeout(function(){n[0].focus()},0)},l=function(){var r={key:0,courseDescription:n[0].value};i.$setViewValue(r),i.$render(),o.searchQuery="",t.release(),e.element.css("display","none"),o.$emit("new-course",n[0].value)};s.bind("click",a),s.bind("touchend",a),e.element.find("button").bind("click",l)}),a.placeholder&&s.attr("placeholder",a.placeholder),i.$formatters.unshift(function(e){return e?e:""}),i.$parsers.unshift(function(e){return e}),i.$render=function(){s.val(i.$viewValue?i.$viewValue.courseDescription||"":"")}}}}]),statracker.controller("PreferencesController",[function(){}]),statracker.controller("RegisterController",["$state","accountService","userDataService",function(e,t,r){var o=this,n=[{key:0,clubKey:0,club:{key:0,clubName:"Driver"},teeballFlag:!0,approachFlag:!1,sortOrderNumber:1},{key:0,clubKey:0,club:{key:0,clubName:"3 Wood"},teeballFlag:!0,approachFlag:!1,sortOrderNumber:2},{key:0,clubKey:0,club:{key:0,clubName:"5 Wood"},teeballFlag:!0,approachFlag:!1,sortOrderNumber:3},{key:0,clubKey:0,club:{key:0,clubName:"4 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:4},{key:0,clubKey:0,club:{key:0,clubName:"5 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:5},{key:0,clubKey:0,club:{key:0,clubName:"6 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:6},{key:0,clubKey:0,club:{key:0,clubName:"7 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:7},{key:0,clubKey:0,club:{key:0,clubName:"8 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:8},{key:0,clubKey:0,club:{key:0,clubName:"9 Iron"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:9},{key:0,clubKey:0,club:{key:0,clubName:"Pitching Wedge"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:10},{key:0,clubKey:0,club:{key:0,clubName:"Sand Wedge"},teeballFlag:!1,approachFlag:!0,sortOrderNumber:11}];r.getDefaultClubs().then(function(e){n.forEach(function(t,r){var o=e.find(function(e){return t.club.clubName===e.name});o?(n[r].clubKey=o.key,n[r].club.key=o.key):console.log("what gives?")}),r.addClubs(n).then(function(e){this.clubs=e})}),o.registration={email:"",password:"",confirmPassword:"",hasError:!1,error:""},o.doRegister=function(){o.registration.hasError=!1,o.registration.error="",o.validate()&&t.register(o.registration).success(function(){t.login(o.registration).then(function(){r.getDefaultClubs().then(function(t){n.forEach(function(e,r){var o=t.find(function(t){return e.club.clubName===t.name});o?(n[r].clubKey=o.key,n[r].club.key=o.key):console.log("what gives?")}),r.addClubs(n).then(function(){e.go("tab.rounds")})})})}).error(function(e){o.registration.hasError=!0,o.registration.error=e.error_description?e.error_description:e.modelState?e.modelState:e})},o.validate=function(){return""===o.registration.email?(o.registration.hasError=!0,o.registration.error="An email address is required",!1):""===o.registration.password?(o.registration.hasError=!0,o.registration.error="A password is required",!1):o.registration.password!==o.registration.confirmPassword?(o.registration.hasError=!0,o.registration.error="The passwords do not match",!1):!0}}]),statracker.factory("userDataService",["$http","$q","apiUrl",function(e,t,r){var o=[],n=[],s=[],a=function(){var s=t.defer(),a=t.defer();return o&&o.length>0?s.resolve(o):e.get(r+"/api/users/clubs").then(function(e){e.data&&(o=e.data),s.resolve(o)}),n&&n.length>0?a.resolve(n):e.get(r+"/api/users/courses").then(function(e){e.data&&(n=e.data),a.resolve(n)}),t.all([s.promise,a.promise]).then(function(e){return{clubs:e[0],courses:e[1]}})},i=function(o){var s=t.defer(),a=n&&n.find(function(e){return e.courseDescription.toLowerCase()===o.toLowerCase()});return a?s.resolve(void 0):e.post(r+"/api/users/courses",{courseDescription:o}).then(function(e){n.push(e.data),s.resolve(e.data)}),s.promise},u=function(n){var s=t.defer();return e.post(r+"/api/users/clubs",n).then(function(e){n.key=e.data.key,o.push(n),s.resolve(o)}),s.promise},l=function(n){var s=t.defer();return e.put(r+"/api/users/clubs",n).then(function(){e.get(r+"/api/users/clubs").then(function(e){e.data&&(o=e.data,s.resolve(o))})}),s.promise},c=function(t){var n=o.findIndex(function(e){return e.key===t.key});e.put(r+"/api/users/clubs/"+t.key,t).then(function(e){t.key=e.data.key,o[n]=t})},d=function(n){var s=t.defer(),a=o.findIndex(function(e){return e.key===n.key});return e.delete(r+"/api/users/clubs/"+n.key).then(function(){o.splice(a,1),s.resolve(o)}),s.promise},h=function(){var o=t.defer();return s&&s.length>0?o.resolve(s):e.get(r+"/api/clubs").then(function(e){e.data&&(s=e.data.map(function(e){var t=!0,r=!1;return"Driver"===e.clubName||e.clubName.endsWith("Wood")?(t=!1,r=!0):"Putter"===e.clubName&&(t=!1),{key:e.key,name:e.clubName,sortOrder:e.key,approachFlag:t,teeballFlag:r}})),o.resolve(s)}),o.promise};return{get clubs(){return o},get courses(){return n},getDefaultClubs:h,loadUserData:a,addCourse:i,addClub:u,addClubs:l,updateClub:c,removeClub:d}}]),statracker.directive("approachResultInput",[function(){return{restrict:"AE",templateUrl:"src/rounds/approach/approach-result-input.html",replace:!0,scope:{shot:"="},link:function(e,t){var r=t.find("path"),o=t[0].querySelector("svg"),n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xlink",a=t[0].querySelector("#shots"),i=o.createSVGPoint(),u=function(e){return i.x=e.clientX,i.y=e.clientY,i.matrixTransform(o.getScreenCTM().inverse())},l=function(e,t,r){if(null!=e&&null!=t){var o=document.createElementNS(n,"use"),i="translate("+e+","+t+") scale(1.0)";r&&c(),o.setAttributeNS(s,"xlink:href","#ball"),o.setAttributeNS(null,"transform",i),a.appendChild(o)}},c=function(){if(a.hasChildNodes()){var e,t=a.children;for(e=0;e<t.length;e++)a.removeChild(t[e])}};e.$watch("shot",function(){c(),null!=e.shot.result&&e.shot.result>=0&&l(e.shot.coordinates.x,e.shot.coordinates.y,!0)}),r.bind("click",function(t){var r=u(t);e.shot.result=parseInt(this.getAttribute("data-location")),e.shot.coordinates.x=r.x,e.shot.coordinates.y=r.y,l(r.x,r.y,!0)})}}}]),statracker.controller("ApproachShotController",["$state","$scope","roundService","userData",function(e,t,r,o){var n=this;n.gotoSummary=function(){e.go("^.round-summary")},t.$on("hole_change",function(e,t){r.update(n.round).then(function(){r.setCurrentHole(t),n.shot=n.round.approachShots[t-1]})}),t.$on("$ionicView.loaded",function(){n.clubs=o.clubs.reduce(function(e,t){return t.approachFlag&&e.push({key:t.clubKey,name:t.club.clubName}),e},[])}),t.$on("$ionicView.beforeEnter",function(){n.round=r.getCurrentRound(),n.shot=n.round.approachShots[r.getCurrentHole()-1]}),t.$on("$ionicView.beforeLeave",function(){r.update(n.round)})}]),function(e){var t=["On the green, inside 3 feet","On the green, inside 12 feet, short","On the green, inside 12 feet, short right","On the green, inside 12 feet, right","On the green, inside 12 feet, long right","On the green, inside 12 feet, long","On the green, inside 12 feet, long left","On the green, inside 12 feet, left","On the green, inside 12 feet, short left","On the green, inside 30 feet, short","On the green, inside 30 feet, short right","On the green, inside 30 feet, right","On the green, inside 30 feet, long right","On the green, inside 30 feet, long","On the green, inside 30 feet, long left","On the green, inside 30 feet, left","On the green, inside 30 feet, short left","On the green, outside 30 feet, short","On the green, outside 30 feet, short right","On the green, outside 30 feet, right","On the green, outside 30 feet, long right","On the green, outside 30 feet, long","On the green, outside 30 feet, long left","On the green, outside 30 feet, left","On the green, outside 30 feet, short left","Missed green (less than 6 feet), short","Missed green (less than 6 feet), short right","Missed green (less than 6 feet), right","Missed green (less than 6 feet), long right","Missed green (less than 6 feet), long","Missed green (less than 6 feet), long left","Missed green (less than 6 feet), left","Missed green (less than 6 feet), short left","Missed green, short","Missed green, short right","Missed green, right","Missed green, long right","Missed green, long","Missed green, long left","Missed green, left","Missed green, short left"],r=function(e,t){t?(this.key=t.key,this.hole=t.holeNumber,this.clubKey=t.clubKey,this.yardage=t.yardageNumber,this.result=t.resultId,this.coordinates={x:t.resultXNumber,y:t.resultYNumber}):(this.key=void 0,this.hole=e,this.clubKey=void 0,this.yardage=void 0,this.result=void 0,this.coordinates=void 0)},o=function(){return{key:this.key,holeNumber:this.hole,clubKey:this.clubKey,yardageNumber:this.yardage,resultId:this.result,resultXNumber:this.coordinates?this.coordinates.x:void 0,resultYNumber:this.coordinates?this.coordinates.y:void 0}},n=function(){return t[this.result]};r.prototype={constructor:r,toApi:o,getResultText:n},e.ApproachShot=r}(statracker),statracker.directive("teeResultInput",[function(){return{restrict:"AE",templateUrl:"src/rounds/tee/tee-result-input.html",replace:!0,scope:{shot:"="},link:function(e,t){var r=t.find("rect"),o=t[0].querySelector("svg"),n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xlink",a=t[0].querySelector("#shots"),i=o.createSVGPoint(),u=function(e){return i.x=e.clientX,i.y=e.clientY,i.matrixTransform(o.getScreenCTM().inverse())},l=function(e,t,r){if(null!=e&&null!=t){var o=document.createElementNS(n,"use"),i="translate("+e+","+t+") scale(1.0)";r&&c(),o.setAttributeNS(s,"xlink:href","#ball"),o.setAttributeNS(null,"transform",i),a.appendChild(o)}},c=function(){if(a.hasChildNodes()){var e,t=a.children;for(e=0;e<t.length;e++)a.removeChild(t[e])}},d=function(e){var t=Math.floor(e/10)-1,r=200;return r+5*t},h=function(t){var r=e.shot.coordinates&&e.shot.coordinates.x?e.shot.coordinates.x:170,o=372-2.4*(t-200);return{x:r,y:o}};e.$watch("shot",function(){c(),null!=e.shot.result&&e.shot.result>=0&&l(e.shot.coordinates.x,e.shot.coordinates.y,!0)}),e.$watch("shot.distance",function(t,r){void 0!==t&&t!==r&&Number(t)>200&&(e.shot.coordinates=h(Number(t)),l(e.shot.coordinates.x,e.shot.coordinates.y,!0))}),r.bind("click",function(t){var r=u(t);e.shot.result=parseInt(this.getAttribute("data-location")),e.shot.coordinates.x=r.x,e.shot.coordinates.y=r.y,e.$emit("tee_shot_distance",d(e.shot.result)),l(r.x,r.y,!0)})}}}]),statracker.controller("TeeShotController",["$state","$scope","roundService","userData",function(e,t,r,o){var n=this;n.gotoSummary=function(){e.go("^.round-summary")},t.$on("tee_shot_distance",function(e,r){n.shot.distance=r,t.$apply()}),t.$on("hole_change",function(e,t){r.update(n.round).then(function(){r.setCurrentHole(t),n.shot=n.round.teeShots[t-1]})}),t.$on("$ionicView.loaded",function(){n.clubs=o.clubs.reduce(function(e,t){return t.teeballFlag&&e.push({key:t.clubKey,name:t.club.clubName}),e},[])}),t.$on("$ionicView.beforeEnter",function(){n.round=r.getCurrentRound(),n.shot=n.round.teeShots[r.getCurrentHole()-1]}),t.$on("$ionicView.beforeLeave",function(){r.update(n.round)})}]),function(e){var t=["Fairway, less than 200 yards","Miss left (first cut up to 2 paces), less than 200 yards","Miss right (first cut up to 2 paces), less than 200 yards","Big miss left, less than 200 yards","Big miss right, less than 200 yards","Out of play (hazard or OB) left, less than 200 yards","Out of play (hazard or OB) right, less than 200 yards","Fairway, 200 - 225 yards","Miss left (first cut up to 2 paces), 200 - 225 yards","Miss right (first cut up to 2 paces), 200 - 225 yards","Big miss left, 200 - 225 yards","Big miss right, 200 - 225 yards","Out of play (hazard or OB) left, 200 - 225 yards","Out of play (hazard or OB) right, 200 - 225 yards","Fairway, 225 - 250 yards","Miss left (first cut up to 2 paces), 225 - 250 yards","Miss right (first cut up to 2 paces), 225 - 250 yards","Big miss left, 225 - 250 yards","Big miss right, 225 - 250 yards","Out of play (hazard or OB) left, 225 - 250 yards","Out of play (hazard or OB) right, 225 - 250 yards","Fairway, 250 - 275 yards","Miss left (first cut up to 2 paces), 250 - 275 yards","Miss right (first cut up to 2 paces), 250 - 275 yards","Big miss left, 250 - 275 yards","Big miss right, 250 - 275 yards","Out of play (hazard or OB) left, 250 - 275 yards","Out of play (hazard or OB) right, 250 - 275 yards","Fairway, 275 - 300 yards","Miss left (first cut up to 2 paces), 275 - 300 yards","Miss right (first cut up to 2 paces), 275 - 300 yards","Big miss left, 275 - 300 yards","Big miss right, 275 - 300 yards","Out of play (hazard or OB) left, 275 - 300 yards","Out of play (hazard or OB) right, 275 - 300 yards","Fairway, over 300 yards","Miss left (first cut up to 2 paces), over 300 yards","Miss right (first cut up to 2 paces), over 300 yards","Big miss left, over 300 yards","Big miss left, over 300 yards","Out of play (hazard or OB) left, over 300 yards","Out of play (hazard or OB) right, over 300 yards"],r=function(e,t){t?(this.key=t.key,this.hole=t.holeNumber,this.clubKey=t.clubKey,this.distance=t.distanceNumber,this.result=t.resultId,this.coordinates={x:t.resultXNumber,y:t.resultYNumber}):(this.key=void 0,this.hole=e,this.clubKey=void 0,this.distance=void 0,this.result=void 0,this.coordinates=void 0)},o=function(){return{key:this.key,holeNumber:this.hole,clubKey:this.clubKey,distanceNumber:this.distance,resultId:this.result,resultXNumber:this.coordinates?this.coordinates.x:void 0,resultYNumber:this.coordinates?this.coordinates.y:void 0}};r.prototype={constructor:r,toApi:o,getResultText:function(){return t[this.result]}},e.TeeShot=r}(statracker),statracker.directive("attemptInput",[function(){return{restrict:"E",templateUrl:"src/rounds/shortgame/attempt-input.html",replace:!0,scope:{flag:"="},link:function(e,t){var r=angular.element(t[0].querySelector("#make")),o=angular.element(t[0].querySelector("#miss")),n=function(){r.hasClass("unselected")||r.addClass("unselected"),o.hasClass("unselected")||o.addClass("unselected")},s=function(){r.hasClass("unselected")&&r.removeClass("unselected"),o.hasClass("unselected")||o.addClass("unselected")},a=function(){r.hasClass("unselected")||r.addClass("unselected"),o.hasClass("unselected")&&o.removeClass("unselected")},i=function(){e.flag===!0?s():e.flag===!1?a():n()};i(),e.$watch("flag",function(){i()}),r.bind("click",function(){void 0===e.flag?(e.flag=!0,s()):(e.flag=void 0,n())}),o.bind("click",function(){void 0===e.flag||e.flag===!0?(e.flag=!1,a()):(e.flag=void 0,n())})}}}]),statracker.directive("puttsInput",[function(){return{restrict:"AE",templateUrl:"src/rounds/shortgame/putts-input.html",replace:!0,scope:{shot:"="},link:function(e,t){var r=t.find("circle"),o=function(){angular.forEach(r,function(e){var t=angular.element(e);t.hasClass("unselected")||t.addClass("unselected"),t.hasClass("selected")&&t.removeClass("selected")})},n=function(e){angular.forEach(r,function(t){var r=parseInt(t.getAttribute("data-value")),o=angular.element(t);r===e?(o.hasClass("selected")||o.addClass("selected"),o.hasClass("unselected")&&o.removeClass("unselected")):(o.hasClass("unselected")||o.addClass("unselected"),o.hasClass("selected")&&o.removeClass("selected"))})},s=function(){e.shot&&null!=e.shot.putts?n(e.shot.putts):o()};s(),e.$watch("shot",function(){s()}),r.bind("click",function(){var t=parseInt(this.getAttribute("data-value"));
e.shot.putts=t,s()})}}}]),statracker.controller("ShortGameController",["$state","$scope","roundService",function(e,t,r){var o=this;o.gotoSummary=function(){e.go("^.round-summary")},t.$on("hole_change",function(e,t){r.update(o.round).then(function(){r.setCurrentHole(t),o.shot=o.round.shortGameShots[t-1]})}),t.$on("$ionicView.beforeEnter",function(){o.round=r.getCurrentRound(),o.shot=o.round.shortGameShots[r.getCurrentHole()-1]}),t.$on("$ionicView.beforeLeave",function(){r.update(o.round)})}]),function(e){var t=function(e,t){t?(this.key=t.key,this.hole=t.holeNumber,this.initialPuttLength=t.initialLengthNumber,this.puttMadeLength=t.finalLengthNumber,this.putts=t.puttsCount,this.upAndDown=t.upAndDownFlag,this.sandSave=t.sandSaveFlag,this.holeOut=t.holeOutFlag):(this.key=void 0,this.hole=e,this.initialPuttLength=void 0,this.puttMadeLength=void 0,this.putts=void 0,this.upAndDown=void 0,this.sandSave=void 0,this.holeOut=void 0)},r=function(){return{key:this.key,holeNumber:this.hole,initialLengthNumber:this.initialPuttLength,finalLengthNumber:this.puttMadeLength,puttsCount:this.putts,upAndDownFlag:this.upAndDown,sandSaveFlag:this.sandSave,holeOutFlag:this.holeOut}};t.prototype={constructor:t,toApi:r},e.ShortGame=t}(statracker);