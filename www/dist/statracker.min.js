"use strict";statracker.controller("HomeController",[function(){}]),angular.module("statracker").run(["$templateCache",function(t){t.put("src/tabs.html","<ion-view><ion-tabs class=tabs-stable><ion-tab title=Rounds icon=ion-flag ui-sref=tab.rounds><ion-nav-view name=rounds></ion-nav-view></ion-tab><ion-tab title=Statistics icon=ion-stats-bars ui-sref=tab.stats><ion-nav-view name=stats></ion-nav-view></ion-tab><ion-tab title=Settings icon=ion-gear-b ui-sref=tab.settings><ion-nav-view name=settings></ion-nav-view></ion-tab></ion-tabs></ion-view>"),t.put("src/account/login-page.html",'<ion-view view-title=Login ng-controller="LoginController as ctrl"><ion-content><div class=row><div class=col><form ng-submit=ctrl.doLogin()><div class=list><label class="item item-input"><span class=input-label>Email</span> <input type=email ng-model=ctrl.credentials.email></label> <label class="item item-input"><span class=input-label>Password</span> <input type=password ng-model=ctrl.credentials.password></label> <label class=item><button class="button button-block button-positive" type=submit ng-disabled=!ctrl.canLogin()>Log in</button></label></div></form></div></div><div class=row ng-show=ctrl.credentials.hasError><div class=col><p>{{ctrl.credentials.error}}</p></div></div><div class=row><div class=col><p>New to StaTracker?</p></div><div class=col><button class="button button-calm" ui-sref=register>Register</button></div></div></ion-content></ion-view>'),t.put("src/account/login.html",'<ion-content><div class=row><div class=col><form ng-submit=ctrl.doLogin()><div class=list><label class="item item-input"><span class=input-label>Email</span> <input type=email ng-model=login.email></label> <label class="item item-input"><span class=input-label>Password</span> <input type=password ng-model=login.password></label> <label class=item><button class="button button-block button-positive" type=submit>Log in</button></label></div></form></div></div><div class=row ng-show=ctrl.credentials.hasError><div class=col><p>{{ctrl.credentials.error}}</p></div></div><div class=row><div class=col><p>New to StaTracker?</p></div><div class=col><button class="button button-calm" ui-sref=register>Register</button></div></div></ion-content>'),t.put("src/account/my-bag.html",'<ion-view view-title="My Bag"><ion-nav-buttons side=primary><button class="button button-small button-clear icon icon-left ion-ios7-arrow-back" ui-sref=^.settings>Back</button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-clear">Edit</button></ion-nav-buttons><ion-content><p>List of clubs for the logged in user, with a way to add, edit, remove clubs from the list. Each club also has editable attributes.</p></ion-content></ion-view>'),t.put("src/account/preferences.html",'<ion-view view-title=Preferences><ion-nav-buttons side=primary><button class="button button-small button-clear icon icon-left ion-ios7-arrow-back" ui-sref=^.settings>Back</button></ion-nav-buttons><ion-content><p>Preference settings governing app behavior</p></ion-content></ion-view>'),t.put("src/account/register.html",'<ion-view view-title=Register><ion-nav-buttons side=primary><button class="button button-small button-clear icon icon-left ion-ios7-arrow-back" ui-sref=login>Back</button></ion-nav-buttons><ion-content><div class=row><div class=col><form ng-submit=doRegister() novalidate><div class=list><label class="item item-input"><span class=input-label>Email</span> <input type=email name=email ng-model=registration.email></label> <label class="item item-input"><span class=input-label>Password</span> <input type=password name=password ng-model=registration.password></label> <label class="item item-input"><span class=input-label>Confirm Password</span> <input type=password name=confirm ng-model=registration.confirmPassword></label> <label class=item><button class="button button-block button-positive" type=submit>Register</button></label></div><div class=row ng-show=registration.hasError><div class=col><p>{{ registration.error }}</p></div></div></form></div></div></ion-content></ion-view>'),t.put("src/account/settings.html",'<ion-view view-title=Settings><ion-content><button class="button button-block" ui-sref=^.my-bag>My Clubs</button> <button class="button button-block" ui-sref=^.preferences>Preferences</button><p>You are logged in as {{user.name}}</p><button class="button button-block" ng-click=doLogout()>Log Out</button></ion-content></ion-view>'),t.put("src/rounds/approach-summary.html",'<ion-view view-title="Approach Shots"><ion-content scroll=false has-bouncing=false nav-prev=^.teeball-summary><p>Round id: {{ round.id }}</p><p>The green SVG image with all approach shots charted.</p></ion-content></ion-view>'),t.put("src/rounds/approach.html",'<ion-view view-title="Approach Shot"><ion-nav-buttons side=primary><button class="button button-small button-clear" ng-click=gotoSummary()>Back</button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small" ng-click=openHoleNav()>{{hole.number}}</button></ion-nav-buttons><ion-content scroll=false has-bouncing=false nav-next=^.round-detail-shortgame nav-prev=^.round-detail-teeball><p>Round id: {{ round.id }}</p><p>Custom SVG control to capture the approach shot for hole {{hole.number}}</p></ion-content></ion-view>'),t.put("src/rounds/create.html",'<ion-view view-title="New Round"><ion-nav-buttons side=primary><button class="button button-small button-clear icon icon-left ion-ios7-arrow-back" ui-sref=^.rounds>Back</button></ion-nav-buttons><ion-content><p>Form to create a new round and go directly to data-entry.</p><a class="button button-assertive" ui-sref="^.round-detail-teeball({id: 400, hole: 1})">Start</a></ion-content></ion-view>'),t.put("src/rounds/goto.html","<ion-popover-view><ion-pane><h1>Go To Specific Hole</h1></ion-pane></ion-popover-view>"),t.put("src/rounds/hole.html",'<ion-view view-title="Round Detail"><ion-tabs class="tabs-top tabs-stable"><ion-tab title="Tee Ball" ui-sref=tab.round-detail.teeball><ion-nav-view name=teeball></ion-nav-view></ion-tab><ion-tab title=Approach ui-sref=tab.round-detail.approach><ion-nav-view name=approach></ion-nav-view></ion-tab><ion-tab title="Short Game" ui-sref=tab.round-detail.shortgame><ion-nav-view name=shortgame></ion-nav-view></ion-tab></ion-tabs></ion-view>'),t.put("src/rounds/list.html",'<ion-view view-title="My Rounds"><ion-nav-buttons side=secondary><button class="button button-small button-clear icon ion-plus" ui-sref=^.new-round></button></ion-nav-buttons><ion-content><ion-list><ion-item ui-sref="tab.round-summary({id: 100})">6/2/2015: Bunker Hills North to East Blue</ion-item><ion-item ui-sref="tab.round-summary({id: 200})">6/5/2015: Bunker Hills North League</ion-item><ion-item ui-sref="tab.round-summary({id: 300})">6/9/2015: Bunker Hills East to West White</ion-item></ion-list></ion-content></ion-view>'),t.put("src/rounds/round-summary.html",'<ion-view view-title="Round Overview"><ion-nav-buttons side=primary><button class="button button-small button-clear" ui-sref=^.rounds>Back</button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small button-clear" ng-click=gotoDetails()>Details</button></ion-nav-buttons><ion-content scroll=false has-bouncing=false nav-next=^.teeball-summary><p>Round id: {{ round.id }}</p><p>Controls to enter the basic round statistics (fairways hit, gir, putts, etc.)</p></ion-content></ion-view>'),t.put("src/rounds/shortgame.html",'<ion-view view-title="Short Game"><ion-nav-buttons side=primary><button class="button button-small button-clear" ng-click=gotoSummary()>Back</button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small" ng-click=openHoleNav()>{{hole.number}}</button></ion-nav-buttons><ion-content scroll=false has-bouncing=false nav-next=^.round-detail-teeball nav-prev=^.round-detail-approach><p>Round id: {{ round.id }}</p><p>Controls to capture short game information for hole {{hole.number}}</p></ion-content></ion-view>'),t.put("src/rounds/teeball-summary.html",'<ion-view view-title="Tee Shots"><ion-content scroll=false has-bouncing=false nav-next=^.approach-summary nav-prev=^.round-summary><p>Round id: {{ round.id }}</p><p>The fairway SVG image with all tee shots charted.</p></ion-content></ion-view>'),t.put("src/rounds/teeball.html",'<ion-view view-title="Tee Shot"><ion-nav-buttons side=primary><button class="button button-small button-clear" ng-click=gotoSummary()>Back</button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small" ng-click=openHoleNav()>{{hole.number}}</button></ion-nav-buttons><ion-content scroll=false has-bouncing=false nav-next=^.round-detail-approach nav-prev=^.round-detail-shortgame><p>Round id: {{ round.id }}</p><p>Custom SVG control to capture tee shot for hole {{hole.number}}</p></ion-content></ion-view>'),t.put("src/stats/approach.html",'<ion-view view-title="Approach Shots"><ion-nav-buttons side=primary><button class="button button-small button-clear icon ion-navicon" ng-click=openMenu()></button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small button-clear icon ion-funnel" ng-click=openFilter()></button></ion-nav-buttons><ion-content has-bouncing=false nav-prev=^.teeball nav-next=^.shortgame><p>Approach-only numerical statistics, trends, and heat map for the current period.</p></ion-content></ion-view>'),t.put("src/stats/filter.html","<ion-popover-view><ion-content><h1>Filter Settings</h1></ion-content></ion-popover-view>"),t.put("src/stats/overall.html",'<ion-view view-title=Overall><ion-nav-buttons side=primary><button class="button button-small button-clear icon ion-navicon" ng-click=openMenu()></button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small button-clear icon ion-funnel" ng-click=openFilter()></button></ion-nav-buttons><ion-content has-bouncing=false nav-prev=^.shortgame nav-next=^.teeball><p>Overall statistics and trends for the current period.</p></ion-content></ion-view>'),t.put("src/stats/shortgame.html",'<ion-view view-title="Short Game"><ion-nav-buttons side=primary><button class="button button-small button-clear icon ion-navicon" ng-click=openMenu()></button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small button-clear icon ion-funnel" ng-click=openFilter()></button></ion-nav-buttons><ion-content has-bouncing=false nav-prev=^.approach nav-next=^.overall><p>Short-game-only numerical statistics and trends for the current period.</p></ion-content></ion-view>'),t.put("src/stats/stats.html","<ion-view><ion-nav-view name=stats-detail></ion-nav-view></ion-view>"),t.put("src/stats/teeball.html",'<ion-view view-title="Tee Shots"><ion-nav-buttons side=primary><button class="button button-small button-clear icon ion-navicon" ng-click=openMenu()></button></ion-nav-buttons><ion-nav-buttons side=secondary><button class="button button-small button-clear icon ion-funnel" ng-click=openFilter()></button></ion-nav-buttons><ion-content has-bouncing=false nav-prev=^.overall nav-next=^.approach><p>Teeball-only numerical statistics, trends, and heat map for the current period.</p></ion-content></ion-view>')}]),statracker.controller("AccountController",["$scope","$state","accountService",function(t,o,n){t.user=n.user(),t.doLogout=function(){n.logout(),o.go("login")}}]),statracker.factory("accountService",["$http","store","jwtHelper","apiUrl","clientId",function(t,o,n,e,r){var a={authenticated:!1,id:"",name:"",email:""},i=function(i){var l="grant_type=password&username="+i.email+"&password="+i.password+"&client_id="+r;return t({url:e+"token",method:"POST",data:l,skipAuthorization:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(t){var e=n.decodeToken(t.access_token);a.authenticated=!0,a.id=e.nameid,a.name=e.sub,a.email=e.sub,o.set("user",a),o.set("access_token",t.access_token),o.set("refresh_token",t.refresh_token)}).error(function(){s()})},s=function(){return a.authenticated&&t.post(e+"api/account/logout"),o.remove("access_token"),o.remove("refresh_token"),o.remove("user"),a={}},l=function(o){return s(),t({url:e+"api/account/register",method:"POST",data:o,skipAuthorization:!0})},c=function(){var t=o.get("user");return void 0===t||null===t?void 0:t},u=function(){var n=o.get("refresh_token"),a="grant_type=refresh_token&refresh_token="+n+"&client_id="+r;return n?t({url:e+"token",method:"POST",skipAuthorization:!0,data:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(t){o.set("access_token",t.access_token),o.set("refresh_token",t.refresh_token)}).error(function(){s()}):void 0};return{login:i,logout:s,register:l,user:c,refresh:u}}]),statracker.controller("LoginController",["$state","accountService",function(t,o){this.credentials={email:"",password:"",hasError:!1,error:""},this.canLogin=function(){return this.credentials.email&&this.credentials.email.length>0&&this.credentials.password&&this.credentials.password.length>0},this.doLogin=function(){var n=this;n.credentials.hasError=!1,n.credentials.error="",o.login(this.credentials).success(function(){t.go("tab.rounds")}).error(function(t){n.credentials.hasError=!0,n.credentials.error=null===t?"Cannot reach the StaTracker authorization server":t.error_description})}}]),statracker.directive("login",[function(){return{scope:{},templateUrl:"js/account/login.html",replace:!0,bindToController:!0,controller:"loginController",controllerAs:"ctrl"}}]).controller("loginController",["$state","accountService",function(t,o){this.credentials={email:"",password:"",hasError:!1,error:""},this.doLogin=function(){this.credentials.hasError=!1,this.credentials.error="",o.login(this.credentials).success(function(){t.go("tab.rounds")}).error(function(t){this.credentials.hasError=!0,this.credentials.error=t.error_description})}}]),statracker.controller("MyBagController",[function(){}]),statracker.controller("PreferencesController",[function(){}]),statracker.controller("RegisterController",["$scope","$state","accountService",function(t,o,n){t.registration={email:"",password:"",confirmPassword:"",hasError:!1,error:""},t.doRegister=function(){t.registration.hasError=!1,t.registration.error="",t.validate()&&n.register(t.registration).success(function(){n.login(t.registration).then(function(){o.go("tab.rounds")})}).error(function(o){t.registration.hasError=!0,t.registration.error=o.error_description?o.error_description:o.modelState?o.modelState:o})},t.validate=function(){return""===t.registration.email?(t.registration.hasError=!0,t.registration.error="An email address is required",!1):""===t.registration.password?(t.registration.hasError=!0,t.registration.error="A password is required",!1):t.registration.password!==t.registration.confirmPassword?(t.registration.hasError=!0,t.registration.error="The passwords do not match",!1):!0}}]),statracker.config(["$httpProvider","jwtInterceptorProvider",function(t,o){o.tokenGetter=["store","jwtHelper","accountService",function(t,o,n){var e=t.get("access_token"),r=t.get("refresh_token");return e&&r?o.isTokenExpired(e)?n.refresh().then(function(o){var n=o.data.access_token;return t.set("access_token",n),n}):e:null}],t.interceptors.push("jwtInterceptor")}]),statracker.run(["$rootScope","$state","accountService",function(t,o,n){t.$on("$stateChangeStart",function(t,e){var r=n.user(),a=e&&e.data&&e.data.secure;!a||void 0!==r&&r.authenticated||(t.preventDefault(),o.go("login"))})}]),statracker.config(["$httpProvider",function(t){t.interceptors.push(function(t,o){return{request:function(o){return t.$broadcast("loading:show"),o},response:function(o){return t.$broadcast("loading:hide"),o},responseError:function(n){return t.$broadcast("loading:hide"),o.reject(n)}}})}]),statracker.run(["$rootScope","$ionicLoading",function(t,o){t.$on("loading:show",function(){o.show({template:"Loading...",noBackdrop:!0})}),t.$on("loading:hide",function(){o.hide()})}]),statracker.config(["$ionicConfigProvider",function(t){t.tabs.position("bottom"),t.backButton.previousTitleText(!1),t.backButton.icon("ion-ios7-arrow-left")}]).run(function(t){t.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault()})}),statracker.config(["$stateProvider","$urlRouterProvider",function(t,o){t.state("login",{url:"/login",templateUrl:"src/account/login-page.html",controller:"LoginController"}).state("register",{url:"/register",templateUrl:"src/account/register.html",controller:"RegisterController"}).state("tab",{url:"/tab","abstract":!0,templateUrl:"src/tabs.html",data:{secure:!0}}).state("tab.settings",{url:"/settings",views:{settings:{templateUrl:"src/account/settings.html",controller:"AccountController"}}}).state("tab.preferences",{url:"/preferences",views:{settings:{templateUrl:"src/account/preferences.html",controller:"PreferencesController"}}}).state("tab.my-bag",{url:"/my-bag",views:{settings:{templateUrl:"src/account/my-bag.html",controller:"MyBagController"}}}).state("tab.rounds",{url:"/rounds",views:{rounds:{templateUrl:"src/rounds/list.html",controller:"ListRoundsController"}}}).state("tab.new-round",{url:"/new-round",views:{rounds:{templateUrl:"src/rounds/create.html",controller:"CreateRoundController"}}}).state("tab.round-summary",{url:"/round-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/round-summary.html",controller:"RoundController"}}}).state("tab.teeball-summary",{url:"/teeball-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/teeball-summary.html",controller:"RoundController"}}}).state("tab.approach-summary",{url:"/approach-summary",params:{id:0},views:{rounds:{templateUrl:"src/rounds/approach-summary.html",controller:"RoundController"}}}).state("tab.round-detail-teeball",{url:"/round-detail-teeball",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/teeball.html",controller:"HoleController"}}}).state("tab.round-detail-approach",{url:"/round-detail-approach",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/approach.html",controller:"HoleController"}}}).state("tab.round-detail-shortgame",{url:"/round-detail-shortgame",params:{id:0,hole:0},views:{rounds:{templateUrl:"src/rounds/shortgame.html",controller:"HoleController"}}}).state("tab.stats",{url:"/stats",views:{stats:{templateUrl:"src/stats/stats.html",controller:"StatsController"}}}).state("tab.stats.overall",{url:"/overall",views:{"stats-detail":{templateUrl:"src/stats/overall.html"}}}).state("tab.stats.teeball",{url:"/teeball",views:{"stats-detail":{templateUrl:"src/stats/teeball.html"}}}).state("tab.stats.approach",{url:"/approach",views:{"stats-detail":{templateUrl:"src/stats/approach.html"}}}).state("tab.stats.shortgame",{url:"/shortgame",views:{"stats-detail":{templateUrl:"src/stats/shortgame.html"}}}),o.otherwise("/login")}]),statracker.controller("CreateRoundController",[function(){}]),statracker.controller("HoleController",["$scope","$state",function(t,o){t.round||(t.round={}),t.round.id=o.params.id,t.hole||(t.hole={}),t.hole.number=o.params.hole,t.gotoSummary=function(){var t=o.params;t.hole=void 0,o.go("^.round-summary",t)}}]),statracker.controller("ListRoundsController",[function(){}]),statracker.directive("navNext",["$state","$ionicGesture","$ionicViewSwitcher",function(t,o,n){return{restrict:"A",link:function(e,r,a){var i=a.navNext;o.on("swipe",function(o){"left"===o.gesture.direction&&(o.preventDefault(),n.nextDirection("forward"),t.is("tab.round-detail-shortgame")&&(n.nextDirection("swap"),void 0!==t.params.hole&&3==t.params.hole?t.params.hole=1:t.params.hole+=1),t.go(i,t.params,{location:"replace"}))},r)}}}]),statracker.directive("navPrev",["$state","$ionicGesture","$ionicViewSwitcher",function(t,o,n){return{restrict:"A",link:function(e,r,a){var i=a.navPrev;o.on("swipe",function(o){"right"===o.gesture.direction&&(o.preventDefault(),n.nextDirection("back"),t.is("tab.round-detail-teeball")&&(n.nextDirection("swap"),void 0!==t.params.hole&&1==t.params.hole?t.params.hole=3:t.params.hole-=1),t.go(i,t.params,{location:"replace"}))},r)}}}]),statracker.controller("RoundController",["$scope","$state",function(t,o){t.round||(t.round={}),t.round.id=o.params.id,t.gotoDetails=function(){var t=o.params;t.hole=1,o.go("^.round-detail-teeball",t)}}]),statracker.controller("StatsController",["$scope","$state",function(t){t.is("tab.stats")&&t.go(".overall")}]);